<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Funko Pop Demon Slayer Collection</title>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0f0f0f;
      color: white;
    }

    h1 {
      text-align: center;
      margin: 20px 0;
    }

    /* --- Scan UI --- */
    .scan-bar {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    input {
      padding: 8px;
      font-size: 16px;
      width: 120px;
      text-align: center;
    }

    button {
      padding: 8px 16px;
      font-size: 16px;
      cursor: pointer;
    }

    /* --- Collection Grid --- */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 16px;
      padding: 16px;
    }

    .card {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 8px;
      text-align: center;
      transition: transform 0.2s;
    }

    .card img {
      width: 100%;
      height: auto;
      transition: filter 0.4s, transform 0.4s;
    }

    /* --- Locked state --- */
    .locked img {
      filter: brightness(0) saturate(100%);
    }

    /* --- Unlock animation --- */
    .unlock {
      animation: unlockFlash 0.6s ease;
    }

    @keyframes unlockFlash {
      0% { transform: scale(1); filter: brightness(0); }
      40% { transform: scale(1.1); filter: brightness(3); }
      100% { transform: scale(1); filter: none; }
    }

    .number {
      margin-top: 6px;
      font-size: 14px;
      opacity: 0.8;
    }
  </style>
</head>

<body>

<h1>Demon Slayer Funko Pop Collection</h1>

<div class="scan-bar">
  <input id="scanInput" placeholder="#615">
  <button onclick="scan()">Scanner</button>
</div>

<div id="collection" class="grid"></div>

<script>
  /* ===============================
     DATA
  =============================== */

  const pops = [
    { number: 615, name: "Tanjiro", rarity: "common" },
    { number: 616, name: "Nezuko", rarity: "rare" },
    { number: 617, name: "Zenitsu", rarity: "common" },
    { number: 618, name: "Inosuke", rarity: "epic" }
  ];

  // Chargé depuis localStorage
  let unlocked = JSON.parse(localStorage.getItem("unlockedPops")) || [];

  /* ===============================
     COLLECTION RENDER
  =============================== */

  const collectionEl = document.getElementById("collection");

  function renderCollection() {
    collectionEl.innerHTML = "";

    pops.forEach(pop => {
      const card = document.createElement("div");
      card.className = "card";

      const img = document.createElement("img");
      img.src = `${pop.number}.png`;

      if (!unlocked.includes(pop.number)) {
        card.classList.add("locked");
      }

      const label = document.createElement("div");
      label.className = "number";
      label.textContent = `#${pop.number}`;

      card.appendChild(img);
      card.appendChild(label);
      collectionEl.appendChild(card);
    });
  }

  /* ===============================
     SCAN LOGIC
  =============================== */

  function scan() {
    const input = document.getElementById("scanInput").value;
    const match = input.match(/\d{3,4}/);

    if (!match) {
      alert("Numéro invalide");
      return;
    }

    const number = parseInt(match[0]);
    const popExists = pops.find(p => p.number === number);

    if (!popExists) {
      alert("Cette Pop n'existe pas");
      return;
    }

    if (unlocked.includes(number)) {
      alert("Déjà débloquée !");
      return;
    }

    unlockPop(number);
  }

  function unlockPop(number) {
    unlocked.push(number);
    localStorage.setItem("unlockedPops", JSON.stringify(unlocked));

    renderCollection();

    // Animation
    const cards = document.querySelectorAll(".card");
    cards.forEach(card => {
      if (card.querySelector(".number").textContent === `#${number}`) {
        card.classList.remove("locked");
        card.classList.add("unlock");
      }
    });
  }

  /* ===============================
     INIT
  =============================== */

  renderCollection();
</script>

</body>
</html>

